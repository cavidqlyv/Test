<%--
====================================================================================================

This file as been imported by the Commander console and the 'Import files' script.

The source of the import is:
C:\Projects\SoftwareMonkeys\SiteStarter\Src\App\WWW\Admin\Errors.aspx

Do not edit this file or changes may be lost. Edit the source file and the changes will be imported by all projects that use it.

====================================================================================================

--%>

<%@ Page Language="C#" AutoEventWireup="true" MasterPageFile="~/Site.master" %>
<%@ Import Namespace="System.Reflection" %>
<%@ Import Namespace="SoftwareMonkeys.WorkHub.Data" %>
<%@ Import Namespace="SoftwareMonkeys.WorkHub.Entities" %>
<%@ Import Namespace="SoftwareMonkeys.WorkHub.Web.Security" %>
<%@ Import Namespace="SoftwareMonkeys.WorkHub.Diagnostics" %>
<%@ Import Namespace="System.Xml" %>
<%@ Import Namespace="System.Xml" %>
<%@ Import Namespace="System.Collections.Generic" %>
<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
    	EnsureAuthorised();
    }
    
    private void EnsureAuthorised()
    {
    	Authorisation.EnsureIsInRole("Administrator");
    }
    
</script>
<asp:Content runat="server" ContentPlaceHolderID="Body">
    <h1>Errors</h1>
    <p>The following errors were found in the log:</p>
    <% foreach (string date in LogUtilities.GetLogDates()){ %>
    	<h2><%= date %></h2>
    	<% foreach (XmlElement error in LogUtilities.GetErrors(date)){ %>
    		<h3><%= LogUtilities.GetComponent(error) %>.<%= LogUtilities.GetMethod(error) %></h3>
			<p><%= LogUtilities.GetTime(error) %></p>
    		<p><%= LogUtilities.GetMessage(error).Replace("\n", "<br/>") %></p>
    		<hr/>
    	<% } %>
    <% } %>
</asp:Content>
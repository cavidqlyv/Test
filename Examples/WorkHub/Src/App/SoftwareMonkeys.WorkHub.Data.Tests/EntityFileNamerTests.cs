/*

====================================================================================================

This file as been imported by the Commander console and the 'Import files' script.

The source of the import is:
C:\Projects\SoftwareMonkeys\SiteStarter\Src\App\SoftwareMonkeys.SiteStarter.Data.Tests\EntityFileNamerTests.cs

Do not edit this file or changes may be lost. Edit the source file and the changes will be imported by all projects that use it.

====================================================================================================


*/

using System;
using NUnit.Framework;
using SoftwareMonkeys.WorkHub.Tests.Entities;
using SoftwareMonkeys.WorkHub.Entities;
using SoftwareMonkeys.WorkHub.Tests;
using System.IO;

namespace SoftwareMonkeys.WorkHub.Data.Tests
{
	[TestFixture]
	public class EntityFileNamerTests : BaseDataTestFixture
	{
		[Test]
		public void Test_CreateFilePath_Reference()
		{
			TestUser user = new TestUser();
			user.FirstName = "First";
			user.ID = Guid.NewGuid();
			
			TestRole role = new TestRole();
			role.ID = Guid.NewGuid();
			
			user.Roles = new TestRole[] {role};
			
			string basePath = TestUtilities.GetTestingPath(this) + Path.DirectorySeparatorChar + "Export";
			
			EntityReference reference = DataAccess.Data.Referencer.GetActiveReferences(user)[0];
			
			string path = new EntityFileNamer(reference, basePath).CreateFilePath();
			
			string expected = basePath + Path.DirectorySeparatorChar
				+ role.ShortTypeName + "-" + user.ShortTypeName + Path.DirectorySeparatorChar
				+ reference.ID.ToString() + ".xml";
			
			Assert.AreEqual(expected, path, "The path doesn't match what's expected.");
			
		}
		
		[Test]
		public void Test_CreateFilePath_Entity()
		{
			TestUser user = new TestUser();
			user.FirstName = "First";
			user.ID = Guid.NewGuid();
			
			string basePath = TestUtilities.GetTestingPath(this) + Path.DirectorySeparatorChar + "Export";
			
			string path = new EntityFileNamer(user, basePath).CreateFilePath();
			
			string expected = basePath + Path.DirectorySeparatorChar + user.GetType() + Path.DirectorySeparatorChar
				+ user.ID.ToString() + ".xml";
			
			Assert.AreEqual(expected, path, "The path doesn't match what's expected.");
			
		}
	}
}
